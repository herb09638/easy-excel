<!doctype html>
<html>
<head>
    <meta charset="utf-8">
    <title>导出 - Easy Excel</title>
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <meta name="description" content="使用简单易用的语义化接口快速读写Excel文件">
    <meta name="keywords" content="Easy Excel, xlsx, csv, ods, box spout">
    <meta name="viewport" content="width=device-width, initial-scale=1">
            <link rel="canonical" href="../../docs-master-export.html" />
    
     <link rel="stylesheet" href="../../assets/css/laravel.css">
     <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/flexboxgrid/6.3.1/flexboxgrid.min.css">
     <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Nunito:200,200i,300,300i,400,400i,600,600i,800,800i,900,900i">
     <link rel="stylesheet" href="../../assets/font-awesome/css/font-awesome.min.css">

             <link rel="stylesheet" href="../../assets/gitalk/gitalk.css">
    
    <script>
        var _hmt = _hmt || [];
        (function() {
            var hm = document.createElement("script");
            hm.src="https://hm.baidu.com/hm.js?86772cdd7983cf277a39d59e4238b721";
            var s = document.getElementsByTagName("script")[0];
            s.parentNode.insertBefore(hm, s);
        })();
    </script>

</head>
<body class="docs language-default">
    
        
        
        
    
    <span class="overlay"></span>

    <nav class="main">
        <a href="../../index.html" class="brand nav-block">
            <span>Easy Excel</span>
        </a>

        <ul class="main-nav">
            <li class=""><a href="../../docs.html">

        文档</a></li>
<li class=""><a href="https://github.com/jqhph/easy-excel" target="_blank">

        Github</a></li>
<li class=""><a href="../../docs.html">
        打赏</a></li>



    
    

        
        

        

        
        
        
        
        
        

    

        </ul>

        <div class="search nav-block invisible">
            <img src="../../assets/svg/search.svg" />
            <input placeholder="search" type="text" id="search-input" aria-label="search"/>
        </div>

                    <div class="switcher">
	<div class="dropdown">
		<button class="btn dropdown-toggle" type="button" id="dropdownMenu1" data-toggle="dropdown" aria-expanded="true">
			Master
			<span class="caret"></span>
		</button>
		<ul class="dropdown-menu" role="menu" aria-labelledby="dropdownMenu1">
							<li role="presentation">
					<a role="menuitem" tabindex="-1" href="../../docs-master-export.html">Master</a>
				</li>
					</ul>
	</div>
</div>
        
        <div class="responsive-sidebar-nav">
            <a href="#" class="toggle-slide menu-link btn">&#9776;</a>
        </div>
    </nav>

    <nav id="slide-menu" class="slide-menu" role="navigation">

	<div class="brand">
		<a href="../../index.html">
			Easy Excel
		</a>
	</div>

	<ul class="slide-main-nav">
		<li><a href="../../index.html">Home</a></li>

		<li class=""><a href="../../docs.html">

        文档</a></li>
<li class=""><a href="https://github.com/jqhph/easy-excel" target="_blank">

        Github</a></li>
<li class=""><a href="../../docs.html">
        打赏</a></li>



    
    

        
        

        

        
        
        
        
        
        

    

	</ul>

	<div class="slide-docs-nav">
		<h2>Documentation</h2>

		<ul class="slide-docs-version">
			<li>
				<h2>Version</h2>

				<ul>
					<li>
													<div class="switcher">
	<div class="dropdown">
		<button class="btn dropdown-toggle" type="button" id="dropdownMenu1" data-toggle="dropdown" aria-expanded="true">
			Master
			<span class="caret"></span>
		</button>
		<ul class="dropdown-menu" role="menu" aria-labelledby="dropdownMenu1">
							<li role="presentation">
					<a role="menuitem" tabindex="-1" href="../../docs-master-export.html">Master</a>
				</li>
					</ul>
	</div>
</div>
											</li>
				</ul>
			</li>
		</ul>

		<ul>
<li>
<h2><a href="../../docs/master/installation.html">安装</a></h2>
</li>
<li>
<h2><a href="../../docs/master/export.html">导出</a></h2>
</li>
<li>
<h2><a href="../../docs/master/import.html">导入</a></h2>
</li>
<li>
<h2><a href="../../docs/master/qa.html">常见问题</a></h2>
</li>
<li>
<h2><a href="../../docs/master/compare.html">框架对比</a></h2>
</li>
<li>
<h2><a href="../../docs/master/update.html">更新日志</a></h2>
</li>
</ul>
	</div>

</nav>

<div class="docs-wrapper container" style="min-height:65vh">

	<section class="sidebar">
		
		<small><a href="#" id="doc-expand" style="font-size: 11px; color: #B8B8B8;">EXPAND ALL</a></small>
		<ul>
<li>
<h2><a href="../../docs/master/installation.html">安装</a></h2>
</li>
<li>
<h2><a href="../../docs/master/export.html">导出</a></h2>
</li>
<li>
<h2><a href="../../docs/master/import.html">导入</a></h2>
</li>
<li>
<h2><a href="../../docs/master/qa.html">常见问题</a></h2>
</li>
<li>
<h2><a href="../../docs/master/compare.html">框架对比</a></h2>
</li>
<li>
<h2><a href="../../docs/master/update.html">更新日志</a></h2>
</li>
</ul>
	</section>

	<article>
		<h1>导出</h1>
<h2>下载</h2>
<p><code  >Exporter::download</code>方法可以通过浏览器下载导出的文件，该方法会根据文件名后缀自动判断导出的文件类型。</p>
<pre><code   class="language-php">use Dcat\EasyExcel\Excel;

$array = [
    [&#039;id&#039; =&gt; 1, &#039;name&#039; =&gt; &#039;Brakus&#039;, &#039;email&#039; =&gt; &#039;treutel@eg.com&#039;, &#039;created_at&#039; =&gt; &#039;...&#039;], 
    ...
];

// 导出xlsx类型文件
Excel::export($array)-&gt;download(&#039;users.xlsx&#039;);
Excel::xlsx($array)-&gt;download(&#039;users.xlsx&#039;);

// 导出csv类型文件
Excel::export($array)-&gt;download(&#039;users.csv&#039;);
Excel::csv($array)-&gt;download(&#039;users.csv&#039;);

// 导出ods类型文件
Excel::export($array)-&gt;download(&#039;users.ods&#039;);
Excel::ods($array)-&gt;download(&#039;users.ods&#039;);</code></pre>
<h2>保存文件</h2>
<p><code  >Exporter::store</code>方法可以保存导出的文件到服务器，该方法会根据文件名后缀自动判断导出的文件类型。</p>
<pre><code   class="language-php">use Dcat\EasyExcel\Excel;

$array = [
    [&#039;id&#039; =&gt; 1, &#039;name&#039; =&gt; &#039;Brakus&#039;, &#039;email&#039; =&gt; &#039;treutel@eg.com&#039;, &#039;created_at&#039; =&gt; &#039;...&#039;], 
    ...
];

// 导出xlsx类型文件
Excel::export($array)-&gt;store(&#039;users.xlsx&#039;);
Excel::xlsx($array)-&gt;store(&#039;users.xlsx&#039;);

// 导出csv类型文件
Excel::export($array)-&gt;store(&#039;users.csv&#039;);
Excel::csv($array)-&gt;store(&#039;users.csv&#039;);

// 导出ods类型文件
Excel::export($array)-&gt;store(&#039;users.ods&#039;);
Excel::ods($array)-&gt;store(&#039;users.ods&#039;);</code></pre>
<h3>Filesystem</h3>
<p><code  >Easy Excel</code> 对 <code  >league/flysystem</code> 提供了支持，通过 <code  >Filesystem</code> 可以轻松的把文件保存到任意服务器，比如阿里云OSS。</p>
<p>这里只为演示用法，如需保存到第三方云存储服务器，则找到相应的<code  >adapter</code>实现包即可。</p>
<pre><code   class="language-php">use Dcat\EasyExcel\Excel;
use League\Flysystem\Adapter\Local;
use League\Flysystem\Filesystem;

$array = [...];

$adapter = new Local(__DIR__);

$filesystem = new Filesystem($adapter);

Excel::export($array)-&gt;disk($filesystem)-&gt;store(&#039;users.xlsx&#039;);
</code></pre>
<h3>在Laravel中使用Filesystem</h3>
<p><code  >Easy Excel</code> 对 <code  >Laravel</code> 的 <code  >Filesystem</code> 也提供了支持：</p>
<p>打开 <code  >config/filesystems.php</code> 中找到如下配置：</p>
<pre><code   class="language-php">return [
    ...

    &#039;disks&#039; =&gt; [

        &#039;local&#039; =&gt; [
            &#039;driver&#039; =&gt; &#039;local&#039;,
            &#039;root&#039; =&gt; storage_path(&#039;app&#039;),
        ],

        ...

    ],
];</code></pre>
<p>使用：</p>
<pre><code   class="language-php">use Dcat\EasyExcel\Excel;

$array = [...];

// local 对应配置参数 config(&#039;filesystems.disks.local&#039;)
Excel::export($array)-&gt;disk(&#039;local&#039;)-&gt;store(&#039;users.xlsx&#039;);

// 也可以
Excel::export($array)-&gt;disk(Storage::disk(&#039;local&#039;))-&gt;store(&#039;users.xlsx&#039;);</code></pre>
<h2>获取文件内容</h2>
<p><code  >Exporter::raw</code>方法可以获取导出的文件的内容。</p>
<pre><code   class="language-php">use Dcat\EasyExcel\Excel;

$array = [
    [&#039;id&#039; =&gt; 1, &#039;name&#039; =&gt; &#039;Brakus&#039;, &#039;email&#039; =&gt; &#039;treutel@eg.com&#039;, &#039;created_at&#039; =&gt; &#039;...&#039;], 
    ...
];

// 导出xlsx类型文件
$xlsxContents = Excel::export($array)-&gt;xlsx()-&gt;raw();
$xlsxContents = Excel::xlsx($array)-&gt;raw();

// 导出csv类型文件
$csvContents = Excel::export($array)-&gt;csv()-&gt;raw();
$csvContents = Excel::csv($array)-&gt;raw();

// 导出ods类型文件
$odsContents = Excel::export($array)-&gt;ods()-&gt;raw();
$odsContents = Excel::ods($array)-&gt;raw();</code></pre>
<h2>设置导出数据</h2>
<p><code  >Easy Excel</code> 提供了多种实用的设置导出数据的接口。</p>
<h3>数组</h3>
<pre><code   class="language-php">use Dcat\EasyExcel\Excel;

$array = [
    [&#039;id&#039; =&gt; 1, &#039;name&#039; =&gt; &#039;Brakus&#039;, &#039;email&#039; =&gt; &#039;treutel@eg.com&#039;, &#039;created_at&#039; =&gt; &#039;...&#039;], 
    ...
];

$exporter = Excel::export($array);</code></pre>
<p>如果传入的参数是带有 <code  >toArray</code> 方法的对象也是可以的</p>
<pre><code   class="language-php">use Dcat\EasyExcel\Excel;
use Dcat\EasyExcel\Support\SheetCollection;

$collection = new SheetCollection([
     [&#039;id&#039; =&gt; 1, &#039;name&#039; =&gt; &#039;Brakus&#039;, &#039;email&#039; =&gt; &#039;treutel@eg.com&#039;, &#039;created_at&#039; =&gt; &#039;...&#039;], 
     ...
 ]);

$exporter = Excel::export($collection);</code></pre>
<h3>分块获取</h3>
<p><code  >Easy Excel</code> 支持分块获取并导出数据，当导出的数据比较多时这个功能非常实用。</p>
<blockquote>
<p>{tip} 此功能的实现原理是使用while循环获取匿名函数返回的值，如果匿名函数返回的结果不为空则循环会一直进行下去，所以需要注意不能让匿名函数的返回值一直不为空。</p>
</blockquote>
<pre><code   class="language-php">use Dcat\EasyExcel\Excel;
use App\User;

Excel::export()
    -&gt;chunk(function (int $times) { // $times 表示循环次数，从1开始，可以当做查询页数实用
        // 每次获取1000条数据导入
        $chunkSize = 1000;

        // 只查询前10页数据
        if ($times &gt; 10) {
            return;
        }

        // 当数据库查不到值时会停止执行闭包内的逻辑
        return User::query()-&gt;forPage($times, $chunkSize)-&gt;get();
    })
    -&gt;download(&#039;users.xlsx&#039;);</code></pre>
<h3>生成器</h3>
<pre><code   class="language-php">use Dcat\EasyExcel\Excel;

// 这里纯粹是为了演示功能，这段代码没有实际意义
$generatorFactory = function () {
    $array = [
        [&#039;id&#039; =&gt; 1, &#039;name&#039; =&gt; &#039;Brakus&#039;, &#039;email&#039; =&gt; &#039;treutel@eg.com&#039;, &#039;created_at&#039; =&gt; &#039;...&#039;], 
        ...
    ];

    foreach ($array as $value) {
        yield $value;
    }
};

$exporter = Excel::export($generatorFactory());
</code></pre>
<p>在<code  >Laravel</code>中可以使用 <code  >Eloquent::cursor</code></p>
<pre><code   class="language-php">use Dcat\EasyExcel\Excel;
use App\User;

$exporter = Excel::export(User::query()-&gt;cursor()-&gt;getIterator());</code></pre>
<h3>匿名函数</h3>
<p>在匿名函数中可以返回数组、对象（<code  >toArray</code>）和生成器。</p>
<pre><code   class="language-php">use Dcat\EasyExcel\Excel;
use Dcat\EasyExcel\Support\SheetCollection;

$exporter = Excel::export(function () {
    return new SheetCollection([
         [&#039;id&#039; =&gt; 1, &#039;name&#039; =&gt; &#039;Brakus&#039;, &#039;email&#039; =&gt; &#039;treutel@eg.com&#039;, &#039;created_at&#039; =&gt; &#039;...&#039;], 
         ...
    ]);
});</code></pre>
<h3>导出数据到多个表格</h3>
<blockquote>
<p>{tip} 此功能只支持导出 <code  >xlsx</code> 和 <code  >ods</code> 类型文件，如果是 <code  >csv</code> 只能导出到一个sheet表格。</p>
</blockquote>
<h4>简单方式</h4>
<p>数组</p>
<pre><code   class="language-php">use Dcat\EasyExcel\Excel;

$sheetArray1 = [
    [&#039;id&#039; =&gt; 1, &#039;name&#039; =&gt; &#039;Brakus&#039;, &#039;email&#039; =&gt; &#039;treutel@eg.com&#039;, &#039;created_at&#039; =&gt; &#039;...&#039;], 
    ...
];
$sheetArray2 = [...];

$sheets = [
    &#039;sheet名称1&#039; =&gt; $sheetArray1, 
    &#039;sheet名称2&#039; =&gt; $sheetArray2, 
    ...
];

Excel::export($sheets)-&gt;store(&#039;users.xlsx&#039;);</code></pre>
<p>分块</p>
<pre><code   class="language-php">use Dcat\EasyExcel\Excel;
use App\User;

$sheets = [
    &#039;sheet名称1&#039; =&gt; function (int $times) {
        if ($times &gt; 10) {
            return;
        }

        // 查询前10页数据
        return User::query()-&gt;forPage($times, 1000)-&gt;get();
    }, 
    &#039;sheet名称2&#039; =&gt; function (int $times) {
        $times += 10;

        // 查询10页之后的数据
        return User::query()-&gt;forPage($times, 1000)-&gt;get();
    }, 
    ...
];

Excel::export()-&gt;chunk($sheets)-&gt;store(&#039;users.xlsx&#039;);</code></pre>
<p>生成器</p>
<pre><code   class="language-php">use Dcat\EasyExcel\Excel;
use App\User;

$sheets = [
    &#039;sheet名称1&#039; =&gt; User::query()-&gt;forPage(1, 1000)-&gt;cursor()-&gt;getIterator(), 
    &#039;sheet名称2&#039; =&gt; User::query()-&gt;forPage(2, 1000)-&gt;cursor()-&gt;getIterator(), 
    ...
];

Excel::export($sheets)-&gt;store(&#039;users.xlsx&#039;);</code></pre>
<p>匿名函数</p>
<pre><code   class="language-php">use Dcat\EasyExcel\Excel;
use App\User;

// 匿名函数可以返回纯数组、对象或生成器
$sheets = function () {
    return [
        &#039;sheet名称1&#039; =&gt; User::query()-&gt;forPage(1, 1000)-&gt;cursor()-&gt;getIterator(), 
        &#039;sheet名称2&#039; =&gt; User::query()-&gt;forPage(2, 1000)-&gt;cursor()-&gt;getIterator(), 
        ...
    ];
};

Excel::export($sheets)-&gt;store(&#039;users.xlsx&#039;)</code></pre>
<h4>Sheet对象</h4>
<blockquote>
<p>{tip} 使用 <code  >Sheet</code> 对象设置导入的值，可以控制每个表格都拥有不同的标题、标题样式以及行样式。</p>
</blockquote>
<p>简单示例：</p>
<pre><code   class="language-php">use Dcat\EasyExcel\Excel;
use App\User;

$sheet = Excel::createSheet(User::query()-&gt;forPage(1, 50)-&gt;get(), &#039;sheet名称1&#039;);

// 单个sheet
Excel::export($sheet)-&gt;download(&#039;users.xlsx&#039;);

// 多个sheet
$sheet1 = Excel::createSheet(User::query()-&gt;forPage(1, 50)-&gt;get(), &#039;sheet名称1&#039;);
$sheet2 = Excel::createSheet(User::query()-&gt;forPage(2, 50)-&gt;get(), &#039;sheet名称2&#039;);

Excel::export([$sheet1, $sheet2])-&gt;download(&#039;users.xlsx&#039;);</code></pre>
<p>同样<code  >Sheet</code>对象也支持传入生成器和分批读取数据导入等功能。</p>
<pre><code   class="language-php">use Dcat\EasyExcel\Excel;
use App\User;

$sheet = Excel::createSheet()-&gt;name(&#039;sheet名称1&#039;)-&gt;chunk(function (int $times) {
    return User::query()-&gt;forPage($times, 1000)-&gt;get();
});

// 单个sheet
Excel::export($sheet)-&gt;download(&#039;users.xlsx&#039;);</code></pre>
<h2>设置标题</h2>
<p><code  >Exporter::headings</code> 方法可以直接设置要导出的文件的标题，并且可以根据标题控制列的排序。</p>
<pre><code   class="language-php">use Dcat\EasyExcel\Excel;

$array = [
    [&#039;id&#039; =&gt; 1, &#039;name&#039; =&gt; &#039;Brakus&#039;, &#039;email&#039; =&gt; &#039;treutel@eg.com&#039;, &#039;created_at&#039; =&gt; &#039;...&#039;], 
    ...
];

// 设置标题，丢弃created_at字段，并更改列的先后顺序，
$headings = [
    &#039;id&#039;    =&gt; &#039;ID&#039;,
    &#039;email&#039; =&gt; &#039;邮箱&#039;,
    &#039;name&#039;  =&gt; &#039;名称&#039;,
];

// 最后导出的列只有 id、email、name 
Excel::export($array)-&gt;headings($headings)-&gt;download(&#039;users.xlsx&#039;);</code></pre>
<p>效果
<a href="../../assets/img/heading.png" target="_blank"></p>
<img style="box-shadow:0 1px 6px 1px rgba(0, 0, 0, 0.12)" width="100%" src="../../assets/img/heading.png" />
<p></a></p>
<h3>禁用标题行</h3>
<p>如果不想导出的文件中带有标题行，可以通过以下方式禁用标题行。</p>
<pre><code   class="language-php">use Dcat\EasyExcel\Excel;

$array = [
    [&#039;id&#039; =&gt; 1, &#039;name&#039; =&gt; &#039;Brakus&#039;, &#039;email&#039; =&gt; &#039;treutel@eg.com&#039;, &#039;created_at&#039; =&gt; &#039;...&#039;], 
    ...
];

// 传入 false 即可
Excel::export($array)-&gt;headings(false)-&gt;download(&#039;users.xlsx&#039;);</code></pre>
<p>如果注入的 <code  >Sheet</code> 对象中设置了标题，则通过 <code  >Exporter::headings</code> 方法禁用标题功能会无效。</p>
<pre><code   class="language-php">use Dcat\EasyExcel\Excel;

$array1 = [
    [&#039;id&#039; =&gt; 1, &#039;name&#039; =&gt; &#039;Brakus&#039;, &#039;email&#039; =&gt; &#039;treutel@eg.com&#039;, &#039;created_at&#039; =&gt; &#039;2019-10-19 00:37:22&#039;], 
];
$array2 = [
    [&#039;id&#039; =&gt; 2, &#039;name&#039; =&gt; &#039;Eichmann&#039;, &#039;email&#039; =&gt; &#039;josefa@eg.com&#039;, &#039;created_at&#039; =&gt; &#039;2019-10-19 00:37:22&#039;],
];

$headings = [&#039;id&#039; =&gt; &#039;ID&#039;, &#039;name&#039; =&gt; &#039;名称&#039;, &#039;email&#039; =&gt; &#039;邮箱&#039;];

$sheet1 = Excel::createSheet($array1);
$sheet2 = Excel::createSheet($array2)-&gt;headings($headings);

Excel::export([$sheet1, $sheet2])-&gt;headings(false)-&gt;download(&#039;users.xlsx&#039;);</code></pre>
<p>效果
<a href="../../assets/img/sheet-heading-1.png" target="_blank"></p>
<img style="box-shadow:0 1px 6px 1px rgba(0, 0, 0, 0.12)" width="100%" src="../../assets/img/sheet-heading-1.png" />
<p></a>
<a href="../../assets/img/sheet-heading-2.png" target="_blank"></p>
<img style="box-shadow:0 1px 6px 1px rgba(0, 0, 0, 0.12)" width="100%" src="../../assets/img/sheet-heading-2.png" />
<p></a></p>
<h3>标题样式</h3>
<blockquote>
<p>{tip} 关于Excel表格的样式定义可以参考文档 <a href="https://opensource.box.com/spout/docs/#styling" target="_blank">box/spout</a>。</p>
</blockquote>
<pre><code   class="language-php">use Box\Spout\Writer\Common\Creator\Style\StyleBuilder;
use Box\Spout\Common\Entity\Style\Color;
use Dcat\EasyExcel\Excel;

$array = [
    [&#039;id&#039; =&gt; 1, &#039;name&#039; =&gt; &#039;Brakus&#039;, &#039;email&#039; =&gt; &#039;treutel@eg.com&#039;, &#039;created_at&#039; =&gt; &#039;...&#039;], 
];

Excel::export($array)
    -&gt;headings(function () {
        $headings = [
            &#039;id&#039;    =&gt; &#039;ID&#039;,
            &#039;email&#039; =&gt; &#039;邮箱&#039;,
            &#039;name&#039;  =&gt; &#039;名称&#039;,
        ];

        // 定义样式
        $style = (new StyleBuilder())
           -&gt;setFontBold()
           -&gt;setFontSize(15)
           -&gt;setFontColor(Color::BLUE)
           -&gt;setShouldWrapText()
           -&gt;setBackgroundColor(Color::YELLOW)
           -&gt;build();

        return [$headings, $style];
    })
    -&gt;download(&#039;users.xlsx&#039;);</code></pre>
<p>效果
<a href="../../assets/img/heading-style.png" target="_blank"></p>
<img style="box-shadow:0 1px 6px 1px rgba(0, 0, 0, 0.12)" width="100%" src="../../assets/img/heading-style.png" />
<p></a></p>
<h3>给每个表格设置不同的标题</h3>
<pre><code   class="language-php">use Dcat\EasyExcel\Excel;
use App\User;

// 创建多个sheet，并设置不同的标题
$user1  = User::query()-&gt;forPage(1, 50)-&gt;get();
$sheet1 = Excel::createSheet($user1, &#039;sheet名称1&#039;)-&gt;headings([...]);

$user2  = User::query()-&gt;forPage(2, 50)-&gt;get();
$sheet2 = Excel::createSheet($user2, &#039;sheet名称2&#039;)-&gt;headings([...]);

Excel::export([$sheet1, $sheet2])-&gt;download(&#039;users.xlsx&#039;);</code></pre>
<h3>给每个表格的标题设置不同的样式</h3>
<pre><code   class="language-php">use Dcat\EasyExcel\Excel;
use Box\Spout\Writer\Common\Creator\Style\StyleBuilder;
use Box\Spout\Common\Entity\Style\Color;

$array1 = [
    [&#039;id&#039; =&gt; 1, &#039;name&#039; =&gt; &#039;Brakus&#039;, &#039;email&#039; =&gt; &#039;treutel@eg.com&#039;, &#039;created_at&#039; =&gt; &#039;2019-10-19 00:37:22&#039;], 
];
$array2 = [
    [&#039;id&#039; =&gt; 2, &#039;name&#039; =&gt; &#039;Eichmann&#039;, &#039;email&#039; =&gt; &#039;josefa@eg.com&#039;, &#039;created_at&#039; =&gt; &#039;2019-10-19 00:37:22&#039;],
];

$sheet1 = Excel::createSheet($array1)-&gt;headingStyle(
    (new StyleBuilder)
        -&gt;setFontColor(Color::BLUE)
        -&gt;setFontSize(14)
        -&gt;build()
);
$sheet2 = Excel::createSheet($array2)-&gt;headingStyle(
     (new StyleBuilder)
         -&gt;setFontColor(Color::RED)
         -&gt;setFontSize(16)
         -&gt;build()
 );

Excel::export([$sheet1, $sheet2])-&gt;download(&#039;users.xlsx&#039;);</code></pre>
<h2>设置内容样式</h2>
<blockquote>
<p>{tip} 关于Excel表格的样式定义可以参考文档 <a href="https://opensource.box.com/spout/docs/#styling" target="_blank">box/spout</a>。</p>
</blockquote>
<h3>设置行样式</h3>
<pre><code   class="language-php">use Box\Spout\Writer\Common\Creator\WriterEntityFactory;
use Box\Spout\Writer\Common\Creator\Style\StyleBuilder;
use Box\Spout\Common\Entity\Style\Color;
use Dcat\EasyExcel\Excel;

$array = [
    [&#039;id&#039; =&gt; 1, &#039;name&#039; =&gt; &#039;Brakus&#039;, &#039;email&#039; =&gt; &#039;treutel@eg.com&#039;, &#039;created_at&#039; =&gt; &#039;2019-10-19 00:37:22&#039;],
    [&#039;id&#039; =&gt; 2, &#039;name&#039; =&gt; &#039;Eichmann&#039;, &#039;email&#039; =&gt; &#039;josefa@eg.com&#039;, &#039;created_at&#039; =&gt; &#039;2019-10-19 00:37:22&#039;],
];

Excel::export($array)
    -&gt;row(function (array $row) {
        // 直接返回原数组，什么也不改变
        if ($row[&#039;id&#039;] &gt; 1) {
            return $row;
        }

        // 设置样式
        $style = (new StyleBuilder())
            -&gt;setFontSize(13)
            -&gt;setFontColor(Color::LIGHT_BLUE)
            -&gt;setShouldWrapText()
            -&gt;build();

        return WriterEntityFactory::createRowFromArray($row, $style);
    })
    -&gt;download(&#039;users.xlsx&#039;);</code></pre>
<p>效果
<a href="../../assets/img/row-style.png" target="_blank"></p>
<img style="box-shadow:0 1px 6px 1px rgba(0, 0, 0, 0.12)" width="100%" src="../../assets/img/row-style.png" />
<p></a></p>
<h3>设置默认样式</h3>
<pre><code   class="language-php">use Box\Spout\Writer\Common\Creator\Style\StyleBuilder;
use Box\Spout\Common\Entity\Style\Color;
use Dcat\EasyExcel\Excel;

$array = [
    [&#039;id&#039; =&gt; 1, &#039;name&#039; =&gt; &#039;Brakus&#039;, &#039;email&#039; =&gt; &#039;treutel@eg.com&#039;, &#039;created_at&#039; =&gt; &#039;2019-10-19 00:37:22&#039;],
    ...
];

Excel::export($array)
    -&gt;option(function ($writer) {
        // 设置样式
        $style = (new StyleBuilder())
            -&gt;setFontSize(13)
            -&gt;setFontColor(Color::LIGHT_BLUE)
            -&gt;setShouldWrapText()
            -&gt;build();

        $writer-&gt;setDefaultRowStyle($style);
    })
    -&gt;download(&#039;users.xlsx&#039;);</code></pre>
<h3>给每个表格行内容设置不同的样式</h3>
<pre><code   class="language-php">use Dcat\EasyExcel\Excel;
use Box\Spout\Writer\Common\Creator\Style\StyleBuilder;
use Box\Spout\Common\Entity\Style\Color;
use Box\Spout\Writer\Common\Creator\WriterEntityFactory;

$array1 = [
    [&#039;id&#039; =&gt; 1, &#039;name&#039; =&gt; &#039;Brakus&#039;, &#039;email&#039; =&gt; &#039;treutel@eg.com&#039;, &#039;created_at&#039; =&gt; &#039;2019-10-19 00:37:22&#039;], 
];
$array2 = [
    [&#039;id&#039; =&gt; 2, &#039;name&#039; =&gt; &#039;Eichmann&#039;, &#039;email&#039; =&gt; &#039;josefa@eg.com&#039;, &#039;created_at&#039; =&gt; &#039;2019-10-19 00:37:22&#039;],
];

$sheet1 = Excel::createSheet($array1)-&gt;row(function (array $row) {
    $style = (new StyleBuilder)
         -&gt;setFontColor(Color::BLUE)
         -&gt;setFontSize(14)
         -&gt;build();

    return WriterEntityFactory::createRowFromArray($row, $style);     
});
$sheet2 = Excel::createSheet($array2)-&gt;row(function (array $row) {
    $style = (new StyleBuilder)
         -&gt;setFontColor(Color::RED)
         -&gt;setFontSize(16)
         -&gt;build();

    return WriterEntityFactory::createRowFromArray($row, $style);          
});

Excel::export([$sheet1, $sheet2])-&gt;download(&#039;users.xlsx&#039;);</code></pre>

		<div id="comment-container" style="margin-top: 90px"></div>
	</article>

</div>

    <footer class="main">
        <ul>
            <li class=""><a href="../../docs.html">

        文档</a></li>
<li class=""><a href="https://github.com/jqhph/easy-excel" target="_blank">

        Github</a></li>
<li class=""><a href="../../docs.html">
        打赏</a></li>



    
    

        
        

        

        
        
        
        
        
        

    

        </ul>
        <p>Built by <b>jqh</b>. Copyright &copy; 2019</p>
        <p class="less-significant">
            <a href="http://jackmcdade.com">
                Designed by<br>
                assets/svg/jack-mcdade.svg
            </a>
        </p>
    </footer>

    <div class="fixed-bottom-btn"><a class="waves-effect waves-light" id="go-top"><i class="fa fa-chevron-up"></i></a></div>

    <script>
    var DcatPage = {
        version: 'master',

        getDocUrl: function (doc) {
            var temp = 'docs/master/{doc}.html';

            if (location.pathname.indexOf(temp.replace('{doc}.html', '')) !== -1) {
                return doc+'.html';
            }

            return temp.replace('{doc}', doc);
        },

        config: {"authors":[{"name":"jqh","email":"841324345@qq.com"}],"homepage":"https:\/\/github.com\/jqhph\/easy-excel","description":"\u4f7f\u7528\u7b80\u5355\u6613\u7528\u7684\u8bed\u4e49\u5316\u63a5\u53e3\u5feb\u901f\u8bfb\u5199Excel\u6587\u4ef6","website":{"title":"Easy Excel","keywords":"Easy Excel, xlsx, csv, ods, box spout","description":"\u4f7f\u7528\u7b80\u5355\u6613\u7528\u7684\u8bed\u4e49\u5316\u63a5\u53e3\u5feb\u901f\u8bfb\u5199Excel\u6587\u4ef6"},"doc":{"default":"installation","index":"documentation","version":"master","ignore":[]},"comment":{"enable":true,"clientID":"19ce86605d804660b3b6","clientSecret":"e64e4208f513c396f948699cfddc461d2f6e4b27","repo":"easy-excel-comments","owner":"jqhwx","admin":["jqhwx"],"language":"zh-CN","perPage":15,"pagerDirection":"first"}},
    };

    DcatPage.config.comment.id = 'master/export';

    (function () {
        function indices() {
            var s = document.createElement('script');
            s.type = 'text/javascript';
            s.async = true;
            s.src="../../assets/indices/master.js";
            var x = document.getElementsByTagName('script')[0];
            x.parentNode.insertBefore(s, x);
        }

        setTimeout(indices, 1);
    })();

</script>

             <script src="../../assets/gitalk/gitalk.min.js"></script>
         <script src="../../assets/js/laravel.js"></script>
     <script src="../../assets/js/viewport-units-buggyfill.js"></script>
    <script>window.viewportUnitsBuggyfill.init();</script>

</body>
</html>
